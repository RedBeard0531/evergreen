
{{define "scripts"}}
<script type="text/javascript" src="{{Static "js" "patch_new.js"}}?hash={{ StaticsMD5 }}"></script>
<script type="text/javascript">
  var userTz = {{GetTimezone $.User}}
  var variants = {{.Variants}}
  var tasks = {{.Tasks}}
  var patch= {{.ProjectData.Patch}}
</script>
{{end}}

{{define "title"}}
Evergreen - Configure Patch
{{end}}

{{define "content"}}
<div id="content" class="container-fluid" ng-controller="PatchController" ng-init="setPatchInfo()">
  <notify-box ng-init="destination='errorHeader'"></notify-box>
  <div class="row">
    <div class="col-xs-7">
      <h3>Configure Patch</h3>
      <div class="col-xs-3">
        <input type="text" ng-model="patch.Description" placeholder="none"></input>
      </div>
      <div class="col-xs-5">
        <patch-commit-panel patchinfo="patchContainer" timezone="{{GetTimezone .User}}"></patch-commit-panel>
      </div>
      <div class="col-xs-3">
        <div class="row">
          <div class="col-xs-12 btn btn-primary" ng-disabled="selectionCount().tasks==0">
            Schedule Tasks
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12 muted small text-center">[[selectionCount().tasks]] tasks across [[selectionCount().variants]] variants</div>
        </div>
      </div>
    </div>
  </div>
  <hr/>
  <div class="row">
    <div class="col-xs-10">
      <h5 class="muted" style="padding:5px">
        Click a variant to edit the set of tasks it will run.<br/> Shift-Click or Cmd-Click to edit multiple variants at once.
      </h5>
    </div>
    <div class="col-xs-3">
      <div class="list-group small noselect">
        <a ng-click="selectVariant($event, $index)" ng-repeat="variant in allVariants track by $index"  ng-class="{active:variant.checked}" class="list-group-item noselect">
          [[variant.name]]<span class="badge" ng-show="numSetForVariant(variant)>0">[[numSetForVariant(variant)]]</span>
        </a>
      </div>
    </div>
    <div class="col-xs-9" ng-show="getActiveTasks(allVariants).length > 0">
      <h3>[[selectedVariant.get().name]]</h3>
      <ul id="tasks">
        <li ng-repeat="task in getActiveTasks(allVariants) | orderBy">
          <label>
            <input type="checkbox" tristate-checkbox ng-model="taskStates[task]" ng-model-options="{ getterSetter: true }"></input>
            &nbsp;[[task]]
          </label>
        </li>
      </ul>
    </div>
  </div>
</div>
{{end}}


